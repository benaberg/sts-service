<!DOCTYPE html>
<html>
    <head>
        <title>STS Dashboard</title>
        <style>
            body { font-family: consolas; color: white; text-align: center; margin-top: 50px; background-color: #121212; }
            #temp { font-size: 3rem; }
        </style>
    </head>
    <body>
        <h1 id="temperature">Current Temperature: -</h1>
        <h4 id="lastUpdated">Last Updated: -</h4>
        <script>
            const socket = new WebSocket("ws://localhost:{{WS_PORT}}");
            socket.onmessage = (event) => {
                const data = JSON.parse(event.data);
                document.getElementById("temperature").textContent = "Current Temperature: " + data.temperature + "Â°C";
                document.getElementById("lastUpdated").textContent = "Last Updated: " + formatTimestamp(data.timestamp);
                document.getElementById("lastUpdated").style.visibility = "visible";
            };
            socket.onerror = () => {
                document.getElementById("temperature").textContent = "Connection error.";
                document.getElementById("lastUpdated").style.visibility = "hidden";
            };

            function formatTimestamp(timestampMillis) {
                const date = new Date(timestampMillis);
                const pad = (num) => num.toString().padStart(2, '0');
                const hh = pad(date.getHours());
                const MM = pad(date.getMinutes());
                const ss = pad(date.getSeconds());
                const dd = pad(date.getDate());
                const mm = pad(date.getMonth() + 1);
                const yyyy = date.getFullYear();
                return `${hh}:${MM}:${ss} ${dd}.${mm}.${yyyy}`;
            }
        </script>
    </body>
</html>